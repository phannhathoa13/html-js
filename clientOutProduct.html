<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client</title>
    <link rel="stylesheet" href="adminAddProduct.html">
    <link rel="stylesheet" href="cartPage.html">

    <style>
        .edit-button {
            display: block;
            height: 18px;
            font-size: 0.9rem;
        }

        .div {
            display: inline-block;
            margin: 5px;
        }
    </style>
</head>

<body>
    <div id="container">
        <div class="div">Name Product
            <span id="nameProduct"></span>
        </div>
        <div class="div">Amount
            <span id="amountProduct"></span>
        </div>
        <div class="div">Price
            <span id="priceProduct"></span>
        </div>
        <div class="div" id="buttonContainer"></div>
        <div class="div" id="buttonDelete"></div>
        <div class="div" id="addButton"></div>
    </div>
    <div class="div" id="buttonBack"></div>
    <button onclick="addProduct()">Add Products</button>
    <button onclick="navigateToCart()">viewCart</button>
    <script>
        cart = [];
        const list = JSON.parse(localStorage.getItem('products'))
        for (let index = 0; index < list.length; index++) {
            const element = list[index];
            const nameDivTag = document.createElement("div")
            const amountDivTag = document.createElement("div")
            const priceDivTag = document.createElement("div")
            const buttonBack = document.createElement("button");
            const addButtonDOM = document.createElement("button");
            nameDivTag.id = `tag${index}`
            amountDivTag.id = `amount${index}`
            priceDivTag.id = `price${index}`
            addButtonDOM.className = 'edit-button';
            nameDivTag.textContent = element.name
            amountDivTag.textContent = element.amount
            priceDivTag.textContent = `$ ${element.price}`
            addButtonDOM.textContent = 'Add To Cart';
            addButtonDOM.onclick = () => { addProductToCart(index) };
            document.getElementById('nameProduct').appendChild(nameDivTag)
            document.getElementById('amountProduct').appendChild(amountDivTag)
            document.getElementById('priceProduct').appendChild(priceDivTag)
            document.getElementById('addButton').appendChild(addButtonDOM);
        }
        function addProduct() {
            window.location = "adminAddProduct (1).html";
        }
        function navigateToCart() {
            window.location = "cartPage.html";
        }
        function getCart() {
            cart = JSON.parse(localStorage.getItem('cart'))
            if (cart == undefined || cart == null) {
                cart = []
            }

        }
        function isProductExsitOnArray(index) {
            return cart.some(product => product.index == index)
        }
        addProductToCart = (index) => {
            getCart()
            if (isProductExsitOnArray(index)) {
                cart.map((element) => {
                    if (element.index == index) {
                        element.amount += 1;
                    }
                })
            }
            else if (!isProductExsitOnArray(index) || cart == []) {
                const testElement = {
                    index: index,
                    amount: 1,
                }
                cart.push(testElement)
            }
            localStorage.setItem("cart", JSON.stringify(cart))
        }
    </script>
</body>

</html>